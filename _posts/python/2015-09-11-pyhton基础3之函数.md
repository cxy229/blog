---
layout     : post
title      : python基础3之函数
categories : [python]
tags       : [notes]
---

```python
>>> def fib(n):    # write Fibonacci series up to n
...     """Print a Fibonacci series up to n."""
...     a, b = 0, 1
...     while a < n:
...         print(a, end=' ')
...         a, b = b, a+b
...     print()
...
>>> # Now call the function we just defined:
... fib(2000)
0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597
```

* docstring

```python
>>> def my_function():
...     """Do nothing, but document it.
...
...     No, really, it doesn't do anything.
...     """
...     pass
...
>>> print(my_function.__doc__)
Do nothing, but document it.

    No, really, it doesn't do anything.
```
* 函数的3种形式
	* 默认参数值
	
```python
	def ask_ok(prompt, retries=4, complaint='Yes or no, please!'):
	    while True:
	        ok = input(prompt)
	        if ok in ('y', 'ye', 'yes'):
	            return True
	        if ok in ('n', 'no', 'nop', 'nope'):
	            return False
	        retries = retries - 1
	        if retries < 0:
	            raise OSError('uncooperative user')
	        print(complaint)
```
* 可变参数

```python
def calc(*numbers):
    sum = 0
    for n in numbers:
        sum = sum + n * n
    return sum
>>> calc(1, 2)
5
>>> calc()
0
```
* 关键字参数

```python
def person(name, age, **kw):
    print('name:', name, 'age:', age, 'other:', kw)
>>> person('Michael', 30)
name: Michael age: 30 other: {}
>>> person('Adam', 45, gender='M', job='Engineer')
name: Adam age: 45 other: {'gender': 'M', 'job': 'Engineer'}

>>> extra = {'city': 'Beijing', 'job': 'Engineer'}
>>> person('Jack', 24, city=extra['city'], job=extra['job'])
name: Jack age: 24 other: {'city': 'Beijing', 'job': 'Engineer'}
>>> extra = {'city': 'Beijing', 'job': 'Engineer'}
>>> person('Jack', 24, **extra) #传入dict
name: Jack age: 24 other: {'city': 'Beijing', 'job': 'Engineer'}
```

```python
def person(name, age, *, city, job):
    print(name, age, city, job)
    
 >>> person('Jack', 24, city='Beijing', job='Engineer')
Jack 24 Beijing Engineer
```
*  任意参数列表 

```python
def f1(a, b, c=0, *args, **kw):
    print('a =', a, 'b =', b, 'c =', c, 'args =', args, 'kw =', kw)
>>> f1(1, 2, 3, 'a', 'b', x=99)
a = 1 b = 2 c = 3 args = ('a', 'b') kw = {'x': 99}
```

```python
def f2(a, b, c=0, *, d, **kw):
    print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'kw =', kw)
>>> f2(1, 2, d=99, ext=None)
a = 1 b = 2 c = 0 d = 99 kw = {'ext': None}
```

* generator  #生成器

```python
>>> g = (x * x for x in range(10))#括号
>>> for n in g:
...     print(n)
... 
0
1
4
9
16
25
36
49
64
81
```

```python
def triangles():
	l = [1]
	while True:
	    yield(l)  #
	    l.append(0)
	    l = [l[i]+l[i-1] for i in range(len(l))]
n = 0
for t in triangles():
    print(t)
    n = n + 1
    if n == 3:
        break
[1]
[1, 1]
[1, 2, 1]
```
* Iterable #表示可迭代的对象
* Iterator #表示迭代器

* map  #1个参数的function

```python
>>> list(map(str, [1, 2, 3, 4, 5, 6, 7, 8, 9]))
['1', '2', '3', '4', '5', '6', '7', '8', '9']
```
* reduce  #2个参数的function

```python
>>> from functools import reduce
>>> def fn(x, y):
...     return x * 10 + y
...
>>> reduce(fn, [1, 3, 5, 7, 9])
13579
```
* filter()

```python
def is_odd(n):
    return n % 2 == 1
list(filter(is_odd, [1, 2, 4, 5, 6, 9, 10, 15]))
 #结果: [1, 5, 9, 15]
```
* sorted()

```python
>>> sorted(['bob', 'about', 'Zoo', 'Credit'], key=str.lower, reverse=True)
['Zoo', 'Credit', 'bob', 'about']
```
* 可返回函数
* 匿名函数lambda

```python
>>> list(map(lambda x: x * x, [1, 2, 3, 4, 5, 6, 7, 8, 9]))
[1, 4, 9, 16, 25, 36, 49, 64, 81]
```
通过对比可以看出，匿名函数lambda x: x * x实际上就是：

```python
def f(x):
    return x * x
```
* 装饰器
* 偏函数 functools.partial()

```python
>>> import functools
>>> int2 = functools.partial(int, base=2)
>>> int2('1000000')
64
>>> int2('1010101')
85
```
* lambda

```python
lower = lambda x,y:x if x<y else y
lower(2,3)
```